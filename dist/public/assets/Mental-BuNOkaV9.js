import{a as S,d as z,r as d,j as e,L as C,A as q,m as c,Q as A,b as u}from"./index-B0BMMOO8.js";import{M as B,B as w}from"./MobileLayout-D2nqiddE.js";import{A as I}from"./arrow-left-CH1M9uQR.js";import{C as M}from"./circle-check-Cfh2Dq-1.js";import{I as _}from"./info-BuNa196L.js";import{R}from"./refresh-ccw-BNQVxVSj.js";function E(){const{t}=S(),{user:m}=z(),[s,n]=d.useState(0),[l,j]=d.useState(null),[h,b]=d.useState({}),[p,f]=d.useState(null),[r,g]=d.useState(null),[H,x]=d.useState(!1),v=async()=>{x(!0),n(10);try{const i=await(await fetch("/api/advanced/quiz/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({domain:"mental_health",userId:m.userId})})).json();j(i),n(1)}catch(a){console.error("Failed to generate quiz:",a),n(0)}finally{x(!1)}},y=(a,i)=>{b(o=>({...o,[a]:i})),setTimeout(()=>{l&&s<l.questions.length?n(o=>o+1):n(7)},300)},N=async()=>{if(p){x(!0),n(10);try{const i=await(await fetch("/api/advanced/quiz/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({domain:"mental_health",userId:m.userId,answers:h,metadata:{sleepHours:p}})})).json();g({score:i.profile.mentalScore,riskBand:parseInt(i.profile.mentalScore)>75?"Excellent":parseInt(i.profile.mentalScore)>45?"Moderate":"High",insight:i.insight}),n(11)}catch(a){console.error("Failed to submit quiz:",a),n(0)}finally{x(!1)}}},k=()=>{b({}),f(null),g(null),n(0)};return e.jsxs(B,{children:[e.jsxs("div",{className:"absolute inset-0 bg-slate-50 z-[-1] overflow-hidden",children:[e.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[500px] h-[500px] bg-purple-100/60 blur-[100px] rounded-full mix-blend-multiply"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[400px] h-[400px] bg-fuchsia-100/60 blur-[100px] rounded-full mix-blend-multiply"})]}),e.jsx("div",{className:"mb-8 pt-4 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(C,{href:"/",children:e.jsx("a",{className:"w-10 h-10 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-600 shadow-sm hover:bg-slate-50 transition-colors",children:e.jsx(I,{className:"w-5 h-5"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-medium tracking-tight text-slate-800 flex items-center gap-2",children:e.jsx("span",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-fuchsia-600",children:t("Mindscape")})}),e.jsx("p",{className:"text-[10px] text-slate-500 font-bold tracking-widest uppercase mt-0.5",children:t("Cognitive Serenity")})]})]})}),e.jsx("div",{className:"bg-white/80 backdrop-blur-xl rounded-[32px] p-6 border border-white shadow-[0_8px_30px_rgba(0,0,0,0.04)] min-h-[480px] flex flex-col relative overflow-hidden",children:e.jsxs(q,{mode:"wait",children:[s===0&&e.jsxs(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"flex-1 flex flex-col items-center justify-center text-center inset-0 absolute p-6",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-50/50 to-fuchsia-50/50 mix-blend-overlay"}),e.jsx("div",{className:"w-24 h-24 rounded-full bg-purple-50 text-purple-600 border border-purple-100 shadow-sm flex items-center justify-center mb-8 relative z-10",children:e.jsx(w,{className:"w-10 h-10"})}),e.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2 tracking-wide relative z-10",children:t("Mind Scan")}),e.jsx("p",{className:"text-xs text-slate-500 mb-10 max-w-[250px] mx-auto leading-relaxed relative z-10 font-medium",children:t("Conduct an interactive psychological assessment to generate a deterministic cognitive score.")}),e.jsxs("button",{onClick:v,className:"w-full max-w-[200px] py-4 bg-gradient-to-r from-purple-600 to-fuchsia-600 hover:from-purple-500 hover:to-fuchsia-500 text-white rounded-[20px] font-bold uppercase tracking-widest text-sm transition-all shadow-lg flex items-center justify-center gap-3 relative z-10",children:[t("Begin Scan")," ",e.jsx(A,{className:"w-5 h-5 text-purple-50"})]})]},"intro"),l&&s>=1&&s<=l.questions.length&&e.jsxs(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"flex-1 flex flex-col w-full h-full inset-0 absolute p-6",children:[e.jsx("div",{className:"mb-8 flex items-center gap-4",children:e.jsx("div",{className:"flex-1 h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500 shadow-sm transition-all duration-500 ease-out",style:{width:`${s/(l.questions.length+1)*100}%`}})})}),e.jsxs("p",{className:"text-[10px] font-bold text-purple-600 uppercase tracking-widest mb-4",children:[t("Parameter")," ",s," ",t("of")," ",l.questions.length]}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 leading-relaxed mb-8",children:l.questions[s-1].title}),e.jsx("div",{className:"space-y-3",children:l.questions[s-1].options.map((a,i)=>{const o=h[l.questions[s-1].id]===a.value;return e.jsxs("button",{onClick:()=>y(l.questions[s-1].id,a.value),className:u("w-full p-5 rounded-[20px] border text-left font-medium transition-all duration-300 flex items-center justify-between shadow-sm",o?"bg-purple-50 border-purple-300 text-purple-900":"bg-white border-slate-200 text-slate-600 hover:border-purple-300 hover:bg-purple-50/50 hover:text-purple-800"),children:[t(a.label),o&&e.jsx(M,{className:"w-5 h-5 text-purple-600"})]},i)})})]},`q${s}`),s===7&&e.jsxs(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"flex-1 flex flex-col w-full h-full inset-0 absolute p-6",children:[e.jsx("div",{className:"mb-8 flex items-center gap-4",children:e.jsx("div",{className:"flex-1 h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500 shadow-sm transition-all duration-500 ease-out",style:{width:"100%"}})})}),e.jsx("p",{className:"text-[10px] font-bold text-purple-600 uppercase tracking-widest mb-4",children:t("Final Step")}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 leading-relaxed mb-8",children:t("Average hours of sleep per night?")}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("input",{type:"number",min:0,max:24,placeholder:"e.g. 7",value:p||"",onChange:a=>f(parseFloat(a.target.value)),className:"w-full text-center text-[40px] font-black p-4 border-b-2 border-slate-100 focus:outline-none focus:border-purple-400 bg-transparent text-slate-800 placeholder-slate-200 transition-colors"}),e.jsx("button",{onClick:N,disabled:!p,className:"w-full mt-6 py-4 bg-gradient-to-r from-purple-600 to-fuchsia-600 hover:from-purple-500 hover:to-fuchsia-500 disabled:opacity-50 disabled:grayscale text-white rounded-[20px] font-bold uppercase tracking-widest transition-all shadow-lg",children:t("Analyze Results")})]})]},"sleep"),s===10&&e.jsxs(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex-1 flex flex-col items-center justify-center text-center inset-0 absolute p-6",children:[e.jsx("div",{className:"w-16 h-16 border-[3px] border-purple-100 border-t-purple-500 rounded-full animate-spin mb-6 text-purple-500 shadow-sm flex items-center justify-center",children:e.jsx(w,{className:"w-6 h-6 animate-pulse text-purple-500"})}),e.jsx("p",{className:"text-xs text-slate-500 font-bold tracking-widest uppercase animate-pulse",children:t("Coalescing Cognition Data...")})]},"loading"),s===11&&r&&e.jsxs(c.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"flex-1 flex flex-col w-full h-full inset-0 absolute p-6 overflow-y-auto custom-scrollbar",children:[e.jsx("h2",{className:"text-xs font-bold tracking-widest uppercase text-slate-500 mb-6 text-center",children:t("Cognitive Stability Matrix")}),e.jsxs("div",{className:u("rounded-[24px] p-8 text-center mb-8 border border-white relative overflow-hidden shadow-[0_8px_30px_rgba(0,0,0,0.04)]",r.riskBand==="High"?"bg-rose-50":r.riskBand==="Moderate"?"bg-amber-50":"bg-purple-50"),children:[e.jsx("span",{className:u("text-[80px] font-black tracking-tight leading-none block mb-2 relative z-10 drop-shadow-sm text-transparent bg-clip-text",r.riskBand==="High"?"bg-gradient-to-b from-rose-500 to-rose-700":r.riskBand==="Moderate"?"bg-gradient-to-b from-amber-500 to-amber-700":"bg-gradient-to-b from-purple-500 to-purple-700"),children:r.score}),e.jsxs("span",{className:u("text-[9px] font-bold uppercase tracking-widest px-3 py-1.5 rounded-full border shadow-sm relative z-10 block w-max mx-auto mt-2",r.riskBand==="High"?"bg-white text-rose-600 border-rose-200":r.riskBand==="Moderate"?"bg-white text-amber-600 border-amber-200":"bg-white text-purple-600 border-purple-200"),children:[t(r.riskBand)," ",t("Phase")]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-bold text-slate-800 mb-4 tracking-wider uppercase text-xs flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-purple-600"}),t("AI Insight")]}),e.jsx("div",{className:"p-5 bg-white rounded-[24px] border border-slate-100 shadow-sm",children:e.jsx("p",{className:"text-[13px] text-slate-600 leading-relaxed font-medium",children:r.insight})})]}),e.jsxs("button",{onClick:k,className:"w-full mt-auto py-4 bg-white border border-slate-200 hover:bg-slate-50 text-slate-700 rounded-[20px] font-bold uppercase tracking-widest text-[11px] transition-all flex items-center justify-center gap-2 shadow-sm",children:[e.jsx(R,{className:"w-4 h-4 text-purple-600"})," ",t("Retake Assessment")]})]},"results")]})})]})}export{E as default};
